<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>So s√°nh l∆∞∆°ng sau thu·∫ø TNCN</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        input {
            width: 140px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ccc;
            padding: 8px;
        }

        th {
            background: #f2f2f2;
        }

        td {
            text-align: right;
        }

        td.label {
            text-align: left;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <h2>So s√°nh l∆∞∆°ng sau thu·∫ø TNCN (Tr∆∞·ªõc & Sau 1/1/2026)</h2>

    <label>L∆∞∆°ng gross:
        <input type="text" id="gross" oninput="formatCurrency(this)">
    </label><br><br>

    <label>% T·ªâ l·ªá l∆∞∆°ng ƒë√≥ng BHXH:
        <input type="number" id="bhSalary" value="60">
    </label><br><br>

    <label>% BHXH (10.5):
        <input type="number" id="bhRate" value="10.5">
    </label><br><br>

    <label>S·ªë ng∆∞·ªùi ph·ª• thu·ªôc:
        <input type="number" id="dependents" value="0">
    </label><br><br>

    <button onclick="calculate()">T√≠nh to√°n</button>

    <table>
        <thead>
            <tr>
                <th>Kho·∫£n</th>
                <th>Tr∆∞·ªõc 1/1/2026</th>
                <th>Sau 1/1/2026</th>
                <th>Ch√™nh l·ªách</th>
            </tr>
        </thead>
        <tbody id="result"></tbody>
    </table>

    <p id="bonusMessage" style="margin-top:15px;font-weight:bold;color:green;"></p>
    </br>
    <p>Tham kh·∫£o: <a href="https://vnexpress.net/quoc-hoi-chot-thue-suat-thu-nhap-ca-nhan-cao-nhat-35-4991877.html" target="_blank">Qu·ªëc h·ªôi ch·ªët thu·∫ø su·∫•t thu nh·∫≠p c√° nh√¢n cao nh·∫•t 35%</a></p>

    <script>
        function formatCurrency(input) {
            // X√≥a t·∫•t c·∫£ k√Ω t·ª± kh√¥ng ph·∫£i s·ªë
            let value = input.value.replace(/[^\d]/g, "");

            // Format theo locale Vi·ªát Nam
            if (value !== "") {
                input.value = Number(value).toLocaleString("vi-VN");
            } else {
                input.value = "";
            }
        }

        // L·∫•y s·ªë thu·∫ßn ƒë·ªÉ t√≠nh to√°n
        function parseCurrency(value) {
            return Number(value.replace(/[^\d]/g, ""));
        }

        function diffColor(v) {
            if (v > 0) return 'style="color:green;"';
            if (v < 0) return 'style="color:red;"';
            return '';
        }


        function calcTax(income, brackets) {
            let tax = 0;
            let prev = 0;
            let currentBracket = { level: 0, rate: 0 };

            for (let i = 0; i < brackets.length; i++) {
                const b = brackets[i];
                if (income > prev) {
                    const taxable = Math.min(income, b.limit);
                    tax += (taxable - prev) * b.rate;
                    currentBracket = { level: i + 1, rate: b.rate };
                    prev = b.limit;
                }
            }
            return { tax, currentBracket };
        }

        function calculate() {
            const gross = parseCurrency(document.getElementById("gross").value) || 0;
            const bhSalary = Number(document.getElementById("bhSalary").value) / 100 || 1;
            const bhRate = Number(document.getElementById("bhRate").value) / 100;
            const dependents = Number(document.getElementById("dependents").value) || 0;

            const bh = gross * bhSalary * bhRate;

            // ===== Thu·∫ø c≈© =====
            const oldPersonal = 11_000_000;
            const oldDependent = dependents * 4_400_000;
            const oldDeduction = oldPersonal + oldDependent;
            const oldTaxable = Math.max(0, gross - bh - oldDeduction);

            const oldBrackets = [
                { limit: 5_000_000, rate: 0.05 },
                { limit: 10_000_000, rate: 0.10 },
                { limit: 18_000_000, rate: 0.15 },
                { limit: 32_000_000, rate: 0.20 },
                { limit: 52_000_000, rate: 0.25 },
                { limit: 80_000_000, rate: 0.30 },
                { limit: Infinity, rate: 0.35 }
            ];

            const oldResult = calcTax(oldTaxable, oldBrackets);
            const oldNet = gross - bh - oldResult.tax;

            // ===== Thu·∫ø m·ªõi =====
            const newPersonal = 15_500_000;
            const newDependent = dependents * 6_200_000;
            const newDeduction = newPersonal + newDependent;
            const newTaxable = Math.max(0, gross - bh - newDeduction);

            const personalDiff = newPersonal - oldPersonal;
            const dependentDiff = newDependent - oldDependent
            const deductionDiff = newDeduction - oldDeduction;
            const taxableDiff = newTaxable - oldTaxable;

            const newBrackets = [
                { limit: 10_000_000, rate: 0.05 },
                { limit: 30_000_000, rate: 0.10 },
                { limit: 60_000_000, rate: 0.20 },
                { limit: 100_000_000, rate: 0.30 },
                { limit: Infinity, rate: 0.35 }
            ];

            const newResult = calcTax(newTaxable, newBrackets);
            const newNet = gross - bh - newResult.tax;

            const resultDiff = newResult.tax - oldResult.tax;


            // ===== So s√°nh l∆∞∆°ng NET =====
            const netDiff = newNet - oldNet;
            const msgEl = document.getElementById("bonusMessage");

            if (netDiff > 0) {
                msgEl.textContent =
                    `üéâ Ch√∫c m·ª´ng! B·∫°n ƒë√£ ƒë∆∞·ª£c "tƒÉng" l∆∞∆°ng th√™m ${netDiff.toLocaleString()} ƒë m·ªói th√°ng k·ªÉ t·ª´ 1/1/2026`;
            } else if (netDiff == 0) {
                msgEl.textContent = "‚ÑπÔ∏è L∆∞∆°ng sau thu·∫ø kh√¥ng thay ƒë·ªïi khi √°p d·ª•ng ch√≠nh s√°ch m·ªõi.";
                msgEl.style.color = "#555";
            }

            document.getElementById("result").innerHTML = `
    <tr><td class="label">BHXH ph·∫£i ƒë√≥ng</td>
        <td>${bh.toLocaleString()}</td>
        <td>${bh.toLocaleString()}</td>
        <td>0</td>
    </tr>

    <tr><td class="label">Gi·∫£m tr·ª´ c√° nh√¢n</td>
        <td>${oldPersonal.toLocaleString()}</td>
        <td>${newPersonal.toLocaleString()}</td>
        <td ${diffColor(personalDiff)}>${personalDiff.toLocaleString()}</td>
    </tr>

    <tr><td class="label">Gi·∫£m tr·ª´ ph·ª• thu·ªôc</td>
        <td>${oldDependent.toLocaleString()}</td>
        <td>${newDependent.toLocaleString()}</td>
        <td ${diffColor(dependentDiff)}>${dependentDiff.toLocaleString()}</td>
    </tr>

    <tr><td class="label">Thu nh·∫≠p t√≠nh thu·∫ø</td>
        <td>${oldTaxable.toLocaleString()}</td>
        <td>${newTaxable.toLocaleString()}</td>
        <td ${diffColor(taxableDiff)}>${taxableDiff.toLocaleString()}</td>
    </tr>

    <tr><td class="label">Thu·∫ø TNCN</td>
        <td>${oldResult.tax.toLocaleString()}</td>
        <td>${newResult.tax.toLocaleString()}</td>
        <td ${diffColor(resultDiff)}>${resultDiff.toLocaleString()}</td>
    </tr>

    <tr><td class="label">B·∫≠c thu·∫ø ƒëang √°p</td>
        <td>B·∫≠c ${oldResult.currentBracket.level} ‚Äì ${oldResult.currentBracket.rate * 100}%</td>
        <td>B·∫≠c ${newResult.currentBracket.level} ‚Äì ${newResult.currentBracket.rate * 100}%</td>
        <td></td>
    </tr>

    <tr><td class="label">L∆∞∆°ng sau thu·∫ø</td>
        <td><b>${oldNet.toLocaleString()}</b></td>
        <td><b>${newNet.toLocaleString()}</b></td>
        <td ${diffColor(netDiff)}>${netDiff.toLocaleString()}</td>
    </tr>
  `;
        }
    </script>

</body>

</html>